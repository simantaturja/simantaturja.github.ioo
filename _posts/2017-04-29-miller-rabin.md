---
layout: post
title: ржорж┐рж▓рж╛рж░ рж░ржмрж┐ржи ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ
category: algorithms
slug: millerrabin
---

ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ ржмрзЗрж░ ржХрж░рж╛рж░ ржЕржирзЗржХржЧрзБрж▓рзЛ ржЙржкрж╛рзЯ ржЖржорж░рж╛ ржЬрж╛ржирж┐ред ржЦрзБржм ржмрзЗрж╢рж┐ ржПржХржЯрж╛ ржЙржкрж╛рзЯ ржирж╛ ржЬрж╛ржирж▓рзЗржУ ржЗрж░рж╛ржЯрзЛрж╕рзНржерзНржпрж╛ржирзЗрж╕ ржПрж░  рж╕рж┐ржн (Sieve of Eratosthenes) тАУ ржПржЗ ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржоржЯрж┐ ржкрзНрж░рж╛рзЯ рж╕ржмрж╛ржЗ ржЬрж╛ржирж┐ред ржХрж┐ржирзНрждрзБ ржмрзЬ ржпрзЗржХрзЛржирзЛ рж╕ржВржЦрзНржпрж╛рж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ рж╕рж┐ржн ржорзЗржержбржЯрж╛ ржЕржирзЗржХ ржмрзЗрж╢рж┐ рж╕ржорзЯ ржирзЗрзЯред рждрж╛ржЗ рж╕рж┐ржн ржПрж░ ржкрж╛рж╢рж╛ржкрж╛рж╢рж┐ ржпржжрж┐ ржЖрж░рзЛ ржХрзЯрзЗржХржЯрж┐ ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржо ржЖржорж╛ржжрзЗрж░ ржЬрж╛ржирж╛ ржерж╛ржХрзЗ рждрж╛рж╣рж▓рзЗ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ ржирж┐рзЯрзЗ ржЖрж░ рж╕ржорж╕рзНржпрж╛ рж╣ржмрзЗ ржирж╛ред

ржЖржорж░рж╛ ржПржЦржи ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ ржмрзЗрж░ ржХрж░рж╛рж░ ржпрзЗ ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржоржЯрж┐ ржжрзЗржЦржм рж╕рзЗржЯрж┐ рж╣рж▓- тАЬржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ (Miller-Rabin Primality Test)тАЭред
ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржо ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржмрзБржЭрждрзЗ ржЧрзЗрж▓рзЗ ржЖржорж╛ржжрзЗрж░ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржмрзБржЭрждрзЗ рж╣ржмрзЗред ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржПржкрзНрж▓рж╛ржЗ ржХрж░рзЗржУ ржЖржорж░рж╛ ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред ржХрж┐ржирзНрждрзБ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржорзЗрж░ ржХрж┐ржЫрзБ рж╕рзАржорж╛ржмржжрзНржзрждрж╛ ржЖржЫрзЗ ржпрж╛рж░ ржлрж▓рзЗ рж╕ржм рж╕ржВржЦрзНржпрж╛рж░ ржЬржирзНржп ржирж┐рж░рзНржнрзБрж▓ ржорж╛ржи ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ ржирж╛ред
ржЖржорж░рж╛ ржкрзНрж░ржержорзЗ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржжрзЗржЦржм, рждрж╛рж░ржкрж░ ржПрж░ рж╕рзАржорж╛ржмржжрзНржзрждрж╛ ржжрзЗржЦржм ржПржмржВ рж╕ржмрж╢рзЗрж╖рзЗ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржХрж┐ржнрж╛ржмрзЗ ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ ржХрж╛ржЬ ржХрж░рзЗ рждрж╛ ржжрзЗржЦржмред

ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржоржГ
ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржЕржирзБржпрж╛рзЯрзА, ржпржжрж┐ n ржПржХржЯрж┐ ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ рж╣рзЯ ржПржмржВ a ржпржжрж┐ n ржПрж░ ржЪрзЗрзЯрзЗ ржЫрзЛржЯ ржпрзЗржХрзЛржи ржзржирж╛рждрзНржоржХ ржкрзВрж░рзНржгрж╕ржВржЦрзНржпрж╛  рж╣рзЯ (1 <= a < n ) рждрж╛рж╣рж▓рзЗ ,
<center>
a<sup>n</sup> тЙб a (mod n)
</center>
<center>
ржмрж╛, a<sup>n тАУ 1</sup> тЙб 1 (mod n) тАжтАжтАж. (i)
</center>

ржЕрж░рзНржерзНржпрж╛рзО, n ржПрж░ ржЪрзЗрзЯрзЗ ржЫрзЛржЯ a ржПрж░ ржпрзЗржХрзЛржирзЛ ржзржирж╛рждрзНржоржХ ржорж╛ржирзЗрж░ ржЬржирзНржп ржпржжрж┐ (i) ржиржВ рж╕ржорзАржХрж░ржг рж╕рждрзНржп ржирж╛ рж╣рзЯ рждрж╛рж╣рж▓рзЗ n рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржорзМрж▓рж┐ржХ ржирзЯ ржПржмржВ ржпржжрж┐ рж╕рждрзНржп рж╣рзЯ рждрж╛рж╣рж▓рзЗ, n рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ред

ржЙржжрж╛рж╣рж░ржг ржжрж┐рзЯрзЗ ржмрзБржЭрж╛ ржпрж╛ржХ тАУ

ржзрж░рж┐, n = 4, ржПржмржВ a = 2, рждрж╛рж╣рж▓рзЗ, (i)ржиржВ тАУ ржП ржорж╛ржи ржмрж╕рж┐рзЯрзЗ ,
<center>
=> 23 (mod 4) = 0
</center>
<center>
ржЕрж░рзНржерзНржпрж╛рзО, 4 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржо ржирзЯред
</center>

ржЖржмрж╛рж░, ржзрж░рж┐ , n = 7 ржПржмржВ a = 5; рждрж╛рж╣рж▓рзЗ, (i)ржиржВ тАУ ржП ржорж╛ржи ржмрж╕рж┐рзЯрзЗ ,

<center>
=> 56 (mod 7) = 1
</center>
<center>
ржЕрж░рзНржерзНржпрж╛рзО, 7 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржоред
</center>
ржПржнрж╛ржмрзЗ, ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ, ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ ржпрж╛рзЯред


ржХрж┐ржирзНрждрзБ ржПрж░ ржХрж┐ржЫрзБ рж╕рзАржорж╛ржмржжрзНржзрждрж╛ ржЖржЫрзЗред ржпрзЗржоржи-

ржзрж░рж┐, n = 15 ржПржмржВ a = 4; рждрж╛рж╣рж▓рзЗ, (i)ржиржВ тАУ ржП ржорж╛ржи ржмрж╕рж┐рзЯрзЗ ,
<center>
=> 414 (mod 15) = 1
</center>
ржЕрж░рзНржерзНржпрж╛рзО, 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржоредржХрж┐ржирзНрждрзБ 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржХрж┐ ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛? ржирж╛, 15 ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ ржирзЯ, ржХрж┐ржирзНрждрзБ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржЕржирзБржпрж╛рзЯрзА, 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ржХрзЗ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржжрзЗржЦрж╛ржЪрзНржЫрзЗред
ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ржЯрж╛ ржорзВрж▓ржд ржПржХржЯрж┐ ржкрзНрж░рзЛржмрж╛ржмрж┐рж▓рж┐рж╕рзНржЯрж┐ржХ ржкрзНрж░рж╕рзЗрж╕ред рждрж╛ржЗ ржПржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ рж╕ржВржЦрзНржпрж╛рж░ ржорзМрж▓рж┐ржХ рж╣ржУрзЯрж╛рж░ рж╕ржорзНржнрж╛ржмрзНржпрждрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗред ржПржЦржи, ржжрзЗржЦрж╛ ржпрж╛ржХ, ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржХрж┐ржнрж╛ржмрзЗ ржЖрж░рзЗржХржЯрзБ ржирж┐рж░рзНржнрзБрж▓ржнрж╛ржмрзЗ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ ржпрж╛рзЯред

ржПржЦржи ржкрж░рзНржпржирзНржд ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ a- ржПрж░ ржПржХржЯрж┐ ржорж╛ржирзЗрж░ ржЬржирзНржп n рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржо ржХрж┐ ржирж╛ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗржЫрж┐рж▓рж╛ржоред ржХрж┐ржирзНрждрзБ ржПржЦржи ржПржХржЯрзБ ржЕржирзНржп ржкржжрзНржзрждрж┐ ржПржкрзНрж▓рж╛ржЗ ржХрж░рж╛ ржпрж╛ржХред ржПржмрж╛рж░  ржЖржорж░рж╛ a тАУ ржПрж░ ржХрзЯрзЗржХржЯрж┐ ржорж╛ржирзЗрж░ ржЬржирзНржп n -ржПрж░ ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ ржХрж░ржмред

ржпрзЗржоржи-
ржзрж░рж┐, a-ржПрж░ ржХрзЯрзЗржХржЯрж┐ ржорж╛ржи = k

ржПржЦржи, ржпржжрж┐, k = 3 рж╣рзЯ, рждрж╛рж╣рж▓рзЗ a ржПрж░ рждрж┐ржиржЯрж┐ ржорж╛ржирзЗрж░ ржЬржирзНржп ржЖржорж░рж╛ n тАУ ржПрж░ ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ ржХрж░ржмред ржпржжрж┐ a-ржПрж░ рждрж┐ржиржЯрж┐ ржорж╛ржирзЗрж░ ржЬржирзНржпржЗ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо рж╕рждрзНржп рж╣рзЯ рждрж╛рж╣рж▓рзЗ ржЖржорж░рж╛ рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржо ржмрж▓ржмред 

ржпржжрж┐ рждрж┐ржиржЯрж┐ ржорж╛ржирзЗрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐рж░ ржЬржирзНржпржУ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо рж╕рждрзНржп ржирж╛ рж╣рзЯ рждрж╛рж╣рж▓рзЗ рж╕ржВржЦрзНржпрж╛ржЯрж┐ржХрзЗ ржиржЯ-ржкрзНрж░рж╛ржЗржо ржмрж▓рзЗ ржШрзЛрж╖ржгрж╛ ржХрж░ржмред ржПржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг ржжрзЗржЦрж╛ ржпрж╛ржХ тАУ

ржзрж░рж┐, n = 15, a = 4 , 3 , 2; рждрж╛рж╣рж▓рзЗ,
<center>
рззред a = 4 ржПрж░ ржЬржирзНржп,
<br>
=> 414 (mod 15) = 1; 
</center>
ржЕрж░рзНржерзНржпрж╛рзО, a = 4 ржПрж░ ржЬржирзНржп 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржоред
<center>
рзиред a = 3 ржПрж░ ржЬржирзНржп,
<br>
=> 314 (mod 15) тЙа 1; 
</center>
ржЕрж░рзНржерзНржпрж╛рзО, a = 3 ржПрж░ ржЬржирзНржп 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржо ржирзЯред

ржПрждржЯрзБржХрзБ ржкрж░рзНржпржирзНржд ржЖрж╕рж╛рж░ ржкрж░ ржЖржорж░рж╛ ржмрзБржЭрзЗ ржЧрзЗржЫрж┐ ржпрзЗ, 15 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржо ржирзЯред a = 2 ржПрж░ ржЬржирзНржп ржЪрзЗржХ ржирж╛ ржХрж░рж▓рзЗржУ ржЪрж▓ржмрзЗред ржХрж╛рж░ржг, n рждржЦржиржЗ ржкрзНрж░рж╛ржЗржо рж╣ржмрзЗ ржпржЦржи a тАУ ржПрж░ k рж╕ржВржЦрзНржпржХ ржорж╛ржирзЗрж░ ржЬржирзНржпржЗ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо рж╕рждрзНржп рж╣ржмрзЗред 

ржЖржЪрзНржЫрж╛, ржПржЗржЦрж╛ржирзЗ ржпрзЗржХрзЛржирзЛ n тАУ ржПрж░ ржЬржирзНржп a тАУ ржПрж░ ржорж╛ржи ржХржд ржерзЗржХрзЗ ржХржд ржкрж░рзНржпржирзНржд рж╣рждрзЗ ржкрж╛рж░рзЗ ржмрж▓рзБржи рждрзЛ? 1 ржерзЗржХрзЗ  n тАУ 1 ржкрж░рзНржпржирзНржд ? ржирж╛ржХрж┐ 2 ржерзЗржХрзЗ n тАУ 2 ржкрж░рзНржпржирзНржд? ржПржХржЯрзБ ржЪрж┐ржирзНрждрж╛ ржХрж░рзЗ ржмрзЗрж░ ржХрж░рзЗ ржлрзЗрж▓рждрзЗ рж╣ржмрзЗ ржХрж┐ржирзНрждрзБ !!

ржПрждржХрзНрж╖ржг ржкрж░рзНржпржирзНржд ржЖрж╕рж╛рж░ ржкрж░ ржЖржорж░рж╛ ржПржЦржи ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ рж▓рж┐ржЯрж▓ ржерж┐ржУрж░рзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржмрзЗрж╢ ржирж┐рж░рзНржнрзБрж▓ржнрж╛ржмрзЗржЗ( рж╕ржорзНржкрзВрж░рзНржг ржирж┐рж░рзНржнрзБрж▓ржнрж╛ржмрзЗ ржирзЯ ржХрж┐ржирзНрждрзБ ЁЯШЙ )  ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░ржмред ржХрж┐ржирзНрждрзБ n = 65, 91, 703, 1729, 1921, 2821, 5611, 8911- ржПржЗ ржХрзЯржЯрж┐ рж╕ржВржЦрзНржпрж╛рж░ ржЬржирзНржп ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо рж╕ржмрж╕ржорзЯржЗ ржмрзНржпрж░рзНрже рж╣ржмрзЗред ржПржЗ ржХрзЯржЯрж┐ рж╕ржВржЦрзНржпрж╛ ржХржорзНржкрзЛржЬрж┐ржЯ ржмрж╛ ржорзМрж▓рж┐ржХ рж╕ржВржЦрзНржпрж╛ ржирж╛ рж╣ржУрзЯрж╛ рж╕рждрзНрждрзНржмрзЗржУ ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржПржЗ рж╕ржВржЦрзНржпрж╛ржЧрзБрж▓рзЛржХрзЗ ржорзМрж▓рж┐ржХ ржмрж▓рзЗ ржжрж╛ржмрж┐ ржХрж░ржмрзЗред ржЖрж░ ржПржЗ рж╕ржорж╕рзНржпрж╛ ржерзЗржХрзЗ ржмрзЗрж░ рж╣рзЯрзЗ ржЖрж╕рж╛рж░ ржЬржирзНржпржЗ ржЖржорж░рж╛ ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯрзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржп ржирзЗржмред


ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржПрж░ ржоржд , ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржкрзНрж░рж╛ржЗржорж╛рж▓рж┐ржЯрж┐ ржЯрзЗрж╕рзНржЯ ржУ ржПржХржЯрж┐ ржкрзНрж░рзЛржмрж╛ржмрж┐рж▓рж┐рж╕рзНржЯрж┐ржХ ржПрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржоред ржХрж┐ржирзНрждрзБ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржПрж░ error rate ржлрж╛рж░рзНржорж╛ржЯ ржЕржкрзЗржХрзНрж╖рж╛ ржХржоред  рждржмрзЗ ржПржЦржи ржжрзЗржЦрзЗ ржлрзЗрж▓рж╛ ржпрж╛ржХ, ржлрж╛рж░рзНржорж╛ржЯ ржерж┐ржУрж░рзЗржорзЗрж░ ржХрж╛ржБржзрзЗрж░ ржЙржкрж░ ржмрж╕рзЗ ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржПрж░ рж╕рж╛рж╣рж╛ржпрзНржп ржирж┐рзЯрзЗ ржХрж┐ржнрж╛ржмрзЗ ржирж┐рж░рзНржнрзБрж▓ржнрж╛ржмрзЗ ржкрзНрж░рж╛ржЗржо ржирж╛ржорзНржмрж╛рж░ ржмрзЗрж░ ржХрж░рж╛ ржпрж╛рзЯред
<br>
<br>
### ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржЯрзЗрж╕рзНржЯржГ

ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржоржЯрж╛ ржЖржмрж╛рж░ ржоржирзЗ ржХрж░рж╛ ржпрж╛ржХ тАУ
a<sup>n тАУ 1</sup> тЙб 1 (mod n)
ржПржЦрж╛ржирзЗ, n рж╣рж┐рж╕рзЗржмрзЗ ржЖржорж░рж╛ рж╢рзБржзрзБ ржмрзЗржЬрзЛрзЬ рж╕ржВржЦрзНржпрж╛ржЧрзБрж▓рзЛржХрзЗржЗ  ржХрж╛ржЙржирзНржЯ ржХрж░ржмред ржХрж╛рж░ржг, ржЖржорж░рж╛ ржЬрж╛ржирж┐, 2 ржЫрж╛рзЬрж╛ ржЖрж░ ржХрзЛржи ржЬрзЛрзЬ рж╕ржВржЦрзНржпрж╛ржЗ ржорзМрж▓рж┐ржХ ржирзЯред ржорж┐рж▓рж╛рж░-рж░ржмрж┐ржи ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржо ржПрж░ ржорзЗржЗржи ржЖржЗржбрж┐рзЯрж╛ рж╣рж▓- (n тАУ 1) -ржХрзЗ 2s.d тАУ ржЖржХрж╛рж░рзЗ рж▓рж┐ржЦржм ;ржпрзЗржЦрж╛ржирзЗ d = ржмрзЗржЬрзЛрзЬ рж╕ржВржЦрзНржпрж╛ред

ржЕрж░рзНржерзНржпрж╛рзО, (n тАУ 1) = (2 ржПрж░ ржкрж╛ржУрзЯрж╛рж░ * ржпрзЗржХрзЛржирзЛ ржмрзЗржЬрзЛрзЬ рж╕ржВржЦрзНржпрж╛)ред
<center>
(n тАУ 1) = 2<sup>s</sup>.d ....тАж..(ii)
</center>
(ii)ржиржВ рж╕рждрзНржп рж╣рж▓рзЗ,
<center>
a<sup>d</sup> тЙб 1 (mod n) тАжтАж. (iii)
</center>
ржпрзЗржХрзЛржирзЛ i тИИ { 0 , тАж , sтИТ1} ржПрж░ ржЬржирзНржп a<sup>2<sup>i</sup></sup>.d тЙб -1(mod n) рж╕рждрзНржп рж╣ржмрзЗред тАжтАж(iv)

(iii) ржЕржержмрж╛ (iv) ржПрж░ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж┐ рж╕рждрзНржп рж╣ржмрзЗред

#### ржкрзНрж░ржорж╛ржгржГ 
<center>
a<sup>n тАУ 1</sup> тЙб a<sup>2<sup>s</sup></sup>.d
<br>
=> a<sup>n тАУ 1</sup> тЙб a<sup>2. 2<sup>s тАУ 1</sup>.d</sup>
<br>
=> a<sup>n тАУ 1</sup> тЙб (a<sup>2<sup>s тАУ 1</sup>.d</sup>)<sup>2</sup>
</center>
ржЕрждржПржм, ржлрж╛рж░рзНржорж╛ржЯрзЗрж░ ржерж┐ржУрж░рзЗржо ржЕржирзБржпрж╛рзЯрзА,
<center>
(a<sup>2<sup>s тАУ 1</sup>.d</sup>)<sup>2</sup> тЙб 1 (mod n)
<br>
(a<sup>2<sup>s тАУ 1</sup>.d</sup>)  тЙб ┬▒1 (mod n)
</center>
ржЖржорж░рж╛ ржПржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг ржжрж┐рзЯрзЗ ржжрзЗржЦржм-
<center>
ржзрж░рж┐, n = 221,
ржПржЦржи, n тАУ 1 = 2<sup>s</sup>.d
<br>
=> 220 = 2<sup>2</sup>.55
<br>
ржПржЦрж╛ржирзЗ , s = 2 ржПржмржВ d = 55ред
<br>
</center>
a = 174 ржПрж░ ржЬржирзНржп тАУ
<center >
a<sup>2<sup>s тАУ 1</sup>.d</sup> = 174<sup>2<sup>2-1</sup>.55</sup>
<br>
= 174<sup>2<sup>1</sup>.55</sup>  
<br>
= 174110 (mod 221)
<br>
= 220 = n тАУ 1
</center>

ржЕрждржПржм, a = 174 ржПрж░ ржЬржирзНржп n = 221 рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржкрзНрж░рж╛ржЗржоред
<br>
ржПржмрж╛рж░, a = 137 ржПрж░ ржЬржирзНржп-
<center>
a<sup>2<sup>s тАУ 1</sup>.d</sup> = 174<sup>2<sup>2-1</sup>.55</sup>
<br>
= 137<sup>2<sup>1</sup>.55</sup>  
<br>
= 137110 (mod 221)
<br>
= 188 тЙа n тАУ 1
<br>
ржпрзЗрж╣рзЗрждрзБ, ржЙрждрзНрждрж░ржЯрж┐ n тАУ 1 ржПрж░ рж╕ржорж╛ржи рж╣рзЯ ржирж┐, рж╕рзЗрж╣рзЗрждрзБ ржПржЦржи ржЖржорж░рж╛ a<sup>2<sup>s-2</sup>.d</sup> ржПрж░ ржорж╛ржи ржмрзЗрж░ ржХрж░ржмред
<br>
a<sup>2<sup>s тАУ 2</sup>.d</sup> = 137<sup>2<sup>2-2</sup>.55</sup>
<br>
= 137<sup>2<sup>0</sup>.55</sup>               
<br>
= 13755 (mod 221)
<br>
= 205 тЙа n тАУ 1
</center>
ржЕрж░рзНржерзНржпрж╛рзО, рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржорзМрж▓рж┐ржХ ржирзЯред ржХрж╛рж░ржг рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржорзМрж▓рж┐ржХ рж╣рждрзЗ рж╣рж▓рзЗ iii ржЕржержмрж╛ iv ржПрж░ ржоржзрзНржпрзЗ ржпрзЗржХрзЛржирзЛ ржПржХржЯрж┐ржХрзЗ рж╕рждрзНржп рж╣рждрзЗ рж╣ржмрзЗред

ржпржжрж┐ (iii) ржПржмржВ (iv)  ржПрж░ ржоржзрзНржпрзЗ ржХрзЛржиржЯрж┐ржЗ рж╕рждрзНржп ржирж╛ рж╣рзЯ рждрж╛рж╣рж▓рзЗ рж╕ржВржЦрзНржпрж╛ржЯрж┐ ржорзМрж▓рж┐ржХ ржирзЯред

ржЖрж╢рж╛ ржХрж░рж┐, ржПржЦржи рж╕рзВржбрзЛржХрзЛржб ржжрзЗржЦрж▓рзЗ рж╕ржмржЯрзБржХрзБ ржХрзНрж▓рж┐рзЯрж╛рж░ рж╣рзЯрзЗ ржпрж╛ржмрзЗ ржПржмржВ ржирж┐ржЬрзЗ ржирж┐ржЬрзЗржЗ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯ ржХрж░рж╛ ржпрж╛ржмрзЗред ЁЯЩВ

рж╕рзВржбрзЛржХрзЛржбржГ
![millerrabin-pseudocode](../assets/images/blog/millerrabin.png)
<center>Source: Wikipedia</center>

ржкрж░ржмрж░рзНрждрзА ржЕржВрж╢рзЗ ржПржЯрж╛рж░ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи ржУ ржХржоржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐ ржирж┐рзЯрзЗ рж▓рж┐ржЦрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржм, ржпржжрж┐ржУ ржирж┐ржЬрзЗ ржПржХржЯрзБ ржкрзЬрж╛рж▓рзЗржЦрж╛ ржХрж░рж▓рзЗржЗ ржПрж░ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи ржУ ржХржоржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐ ржмрзБржЭрзЗ ржлрзЗрж▓рж╛ рж╕ржорзНржнржмред ржХрж┐ржЫрзБ рж▓рж┐ржВржХ ржжрж┐рзЯрзЗ ржжрж┐ржЪрзНржЫрж┐, ржЪрж╛ржЗрж▓рзЗ ржЖрж░ржУ ржбрж┐ржЯрзЗржЗрж▓рзЗ ржкрзЬрзЗ ржирж┐рждрзЗ ржкрж╛рж░рзЗржиред


Additional Resource Links: 

https://en.wikipedia.org/wiki/Fermat%27s_little_theorem
https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test
https://comeoncodeon.wordpress.com/2010/09/18/miller-rabin-primality-test/
https://miller-rabin.appspot.com/

ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕ ржПрж░ ржЬржирзНржп ржкрзНрж░ржмрж▓рзЗржоржГ
[SPOJ-Prime or Not](https://www.spoj.com/problems/PON/)
